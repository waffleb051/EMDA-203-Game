<!DOCTYPE html>
<!--
Coded by Brian Busk II
Most code is created under Creative Commons, except for KeyMonkey created by 
Adam Callaway, for Southern Oregon University EMDA 203 and the Cheet.js to add some flair.
Seriously if you have a chance check out the site just Google it. 
BAC- Blood Alcohol Level
Project Started (05/15) Hours Spent as of this day: 4 hours Cant do anymore because no sprites

-->
<html>
    <head>
        <title>Still Untitled</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="JS/createjs-2015.11.26.min.js"></script>
        <script src="JS/KeyMonkey.js"></script>
        <script src="JS/cheet.js"></script>
        <script src="JS/creatOr.js"></script>
        <script>
            //Global Variables
            var mainStage; //creation of the main stage
            var playName; //allows for the user to place their name in 
            var playCharacter; //the character
            var playScore = 0; //the players score
            var LastplayerScore;
            var charSprite;
            var characterSpeed = 5;
            var sharkSprite; //the shark //array
            var shellArray = new Array(); //the shell array
            var ballArray = new Array(); //the ball array
            var sharkArray = new Array(); //the shark array
            var kPressed; //handles the keypress
            var key; //handles which key is pressed
            var sDisplay;
            var frameRate = 24;
            var sharkSpeed = 25;
            var stageHeight;
            var stageWidth;

            //[Title View]

            var mainImg = new Image();
            var main;
            var startBImg = new Image();
            var startB;
            var creditsBImg = new Image();
            var creditsB;

            //[Title View Group]

            var TitleView = new Container();

            //Loading of the music, and a few images
            var mQueue = new createjs.LoadQueue();
            createjs.Sound.alternateExtensions = ["mp3"];
            mQueue.installPlugin(createjs.Sound);
            mQueue.addEventListener("complete", musicComplete);
            mQueue.loadManifest([
                {id: "main", src: "Music/21st Century Surf.mp3", data: 5}
            ]); //end Preloader

            function musicComplete() {
                Main();
            }//end musicComplete

            function Main() {

                //Stage Creation
                mainStage = new createjs.Stage(document.getElementById("Canvas"));
                stageWidth = myStage.canvas.width;
                stageHeight = myStage.canvas.height;
                //Placing the stage directions
                mainStage.NORTH = 0;
                mainStage.SOUTH = 2;
                mainStage.EAST = 1;
                mainStage.WEST = 3;
                //defining the tile sizes
                mainStage.tileSize = 40; //MAY CHANGE DEPENDING ON THE MISSING SPRITE (05/16)

                //Array to handle keypresses
                kPressed = [];
                //Designated keys array
                key = {w: 87, a: 65, s: 83, d: 68, up: 38, down: 40, left: 37, right: 39};
                //Score floater array
                ScoreText = [];
                //background imgae
                var background = new createjs.Bitmap("Images/background.png");
                mainStage.addChild(background);
                //User name floater


                //Chracter SpriteSheet
                charSprite = new create.jsSpriteSheet(
                        {
                            "images": ["link to the spritesheet file path"],
                            "frames": {width: 128, height: 128, count: 48},
                            "animation": {
                                "idle": {frames: [0]},
                                "blink": {frames: [1, 2, 3], speed: characterSpeed, next: "idle"},
                                "move": {frames: [4 - 11], speed: 0.5}
                            }
                        });//end charSprite

                //Playing the music
                //commented to save my sanity....debugging this code
                //wait chrome has a mute tab option, thank the Force
                var museInstance = createjs.Sound.play("main", {loop: -1});
                museInstance.on("loop", handleLoop);
                function handleLoop(event) {
                    museInstance.volume = museInstance.volume * 0.5;
                }

                //This will handle the unlocking of speed, speeding up the character by a factor
                cheet('↑ ↑ ↓ ↓ ← → ← → b a', function () {
                    alert('Check the Console logs', ohShit());
                });
                //I think this is using a similar function base to the KeyMonkey Class

                //display the player score and the players lives
                //player score
//                sDisplay.x = 20;
//                sDisplay.y = 10;
//                sDisplay.textBaseline = "alphabetic";

                createjs.Ticker.addEventListener("tick", drawNewFrame);
            }//end init

            function ShellSharkBallSpawn() {
                this.shell = new createjs.Bitmap("Images/shell#1.png");
                //Change the following images
                this.shark = new createjs.Bitmap("Images/shell#1.png");
                this.ball = new createjs.Bitmap("Images/shell#1.png");
               
               //Creating the starting spawn
               //Shell
               this.shell.x = Math.floor(Math.random() * stageWidth);
               this.shell.y = 0;
               //Shark
               this.shark.y = Math.floor(Math.random() * stageWidth);
               this.shark.x = 0;
               //ball
               this.ball.y = Math.floor(Math.random() * stageWidth);
               this.ball.x = 0;

                //Adding the characters to the stage
                myStage.addChild(this.shell, this.ball, this.shark);
            }//end ShellSharkBallSpawn

            //spawn fucntion controls the spawning of the shell, shark and ball
            function sssSpawnRate() {
                var randomShell = Math.floor((Math.random() * 3) + 1);
                if (randomShell === 0 && radomShell !== 3) {
                    var shells = new ShellSharkBallSpawn(shell); //spawning a new shell
                    shellArray.push(shells); // pushing the shell into an array
                }//end if
                var randomShark = Math.floor((Math.random() * 20) + 1);
                if (randomShark === 0 && randomShark !== 20) {
                    var sharks = new ShellSharkBallSpawn(shark); //spawning a new shell
                    sharkArray.push(sharks); // pushing the shell into an array
                }//end if
                var randomBall = Math.floor((Math.random() * 20) + 1);
                if (randomBall === 0 && radomBall !== 20) {
                    var balls = new ShellSharkBallSpawn(ball); //spawning a new shell
                    ballArray.push(balls); // pushing the shell into an array
                }//end if
            }//end sssSpawnRate

            //Handles the movment of the shark, shell, and ball
            function Movement() {
                for (var b = 0; b >= shellArray.lenght; b++) {
                    var thisShell = shellArray[b];
                    thisShell.shell.y += 5;
                }//end for

                for (var x = 0; x >= sharkArray.length; x++) {
                    var thisShark = sharkArray[x];
                    thisShark.shark.y += 10;
                }//end for

                for (var y = 0; i >= ballArray.length; y++) {
                    var thisBall = ballArray[y];
                    thisBall.ball.y += 6;
                }//end for

            }//end Movement 

            function addTitleView()
            {
                startB.x = 240 - 31.5;
                startB.y = 160;
                startB.name = 'startB';
            }


            function NewFrame(evt) {
                //functon calls
                sssSpawnRate();
                Movement();


//                if(playerScore != 0){
//                    if(playerScore>LastplayerScore){
//                        
//                    }//end if 
//                    else(playerScore<=LastplayerScore){
//                    
//                }//end else
                mainStage.update();
            }//end NewFrame
            
            //oh shit you unlocked the speed upgrade
            function ohShit(){
                characterSpeed = 9001;
            }
        </script>
    </head>
    <body onload="Main();">
        <!---Modify the canvase based on size of window-->
        <canvas id="Canvas" width="1920" height="1200">Sorry. You need an HTML5 compatible browser to see this.</canvas>
    </body>
</html>
